<html>
<head>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

</head>

<body>


<div id="thumbsucker"></div>

<!-- Calls the thumbsucker URL ever 1 seconds -->
<script type="text/javascript">

var count = 0;
var loop_max = parseInt({{ loop_max }});
(function poll() {
    (setTimeout(function () {
        count = count + 1;
        var url_string = "/thumbsucker/" + count;
        $.ajax({
            type: 'POST',
            url: url_string,
        });
        if ( count < loop_max ) {
          var element = document.getElementById("display");
          element.innerHTML = "Looping " + count + " times.";
          poll();
        }
        else {
          window.location.href = "/done";
        }
    }, 1000));
})();

</script>

<h1 id="display">Looping</h1>


</body>
</html>
